<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head></h:head>

<ui:composition>
	<h:outputStylesheet name="style.css"></h:outputStylesheet>
	<h:outputScript name="js/gmap_utils.js" />
	<h:outputScript name="js/util.js" />
	<div class="dashboard">
		<h:form prependId="false">
			<div class="filter-area" style="border-style: none;">
			<p:panel header="Filter ads">
				<p:panelGrid columns="4" cellpadding="5"  style="width:100%;" styleClass="ui-noborder">

					<p:outputLabel value="Location from:"></p:outputLabel>
					<p:inputText id="from" placeholder="From" styleClass="input-filter"
						value="#{adViewBean.from}">
						<p:ajax update="ads"
							process="from,to,time_from,time_to,category"
							listener="#{adViewBean.filterAds}" event="keyup" />
					</p:inputText>
					<p:outputLabel value="Location to:"></p:outputLabel>
					<p:inputText id="to" placeholder="To" styleClass="input-filter"
						value="#{adViewBean.to}">
						<p:ajax update="ads,tickets"
							process="from,to,time_from,time_to,category"
							listener="#{adViewBean.filterAds}" event="keyup" />
					</p:inputText>
					<p:outputLabel for="@next" value="Time from:"></p:outputLabel>
					<p:calendar styleClass="input-filter" id="time_from" 
						value="#{adViewBean.timeFrom}" navigator="true"
						requiredMessage="Departure time required." yearRange="1900:2050"
						pattern="dd/MM/yyyy HH:mm">
						<p:ajax update="ads"
							process="from,to,time_from,time_to,category"
							listener="#{adViewBean.filterAds}" />
					</p:calendar>
					<p:outputLabel for="@next" value="Time from:"></p:outputLabel>
					<p:calendar styleClass="input-filter" id="time_to"
						value="#{adViewBean.timeTo}" label="departure_time"
						navigator="true" yearRange="1900:2050" pattern="dd/MM/yyyy HH:mm">
						<p:ajax update="ads"
							process="from,to,time_from,time_to,category"
							listener="#{adViewBean.filterAds}" />
					</p:calendar>

				  

					<p:outputLabel for="@next" value="Select category:"></p:outputLabel>
					<p:selectOneButton id="category" value="#{adViewBean.category}">
					<f:selectItem itemLabel="Need" itemValue="Need" />
					<f:selectItem itemLabel="Offer" itemValue="Offer" />
					<f:selectItem itemLabel="All" itemValue="All" />
					<p:ajax update="ads"
							process="from,to,time_from,time_to,category"
							listener="#{adViewBean.filterAds}" />
					
					</p:selectOneButton>
						<p:outputLabel></p:outputLabel>
					<p:commandButton value="Reset" actionListener="#{adViewBean.reset}" styleClass="input-filter"
						update="from,to,time_from,time_to,category,ads,tickets" style="float:center;">

					</p:commandButton>
					</p:panelGrid>
					

				
				</p:panel>
			</div>


			<div>
				<p:carousel id="tickets" value="#{adViewBean.tickets}" var="ticket"
					styleClass="datascroller" chunkSize="10">
					<f:facet name="header">Buy tickets</f:facet>
					<p:panelGrid columns="1" class="ticket-table">
						<p:outputPanel>
							<div class="offer-title" align="center">
								<p:outputLabel value="#{ticket.transportType}"
									style="font-weight:bold;float:left;margin-left:5px"></p:outputLabel>
								<p:commandButton
									style="float: right;margin-right:5px;margin-top:-3px;"
									value="Buy ticket" action="/error.xhtml?faces-redirect=true"
									ajax="false">
									<f:setPropertyActionListener value="#{ticket}"
										target="#{adViewBean.selectedTicket}" />
								</p:commandButton>
							</div>
							<p:panelGrid columns="2" class="ticket-fields ui-noborder">
								<h:outputText value="To:" styleClass="twenty-percent"/>
								<h:outputText value="#{ticket.destination}" styleClass="eighty-percent" />
								<h:outputText value="Price:" styleClass="twenty-percent"/>
								<h:outputText value="#{ticket.price} EUR" styleClass="eighty-percent" />
							</p:panelGrid>

						</p:outputPanel>
					</p:panelGrid>
				</p:carousel>
			</div>



			<p:dataScroller id="ads" value="#{adViewBean.ads}" var="ad"
				chunkSize="10" styleClass="datascroller">
				<f:facet name="header">Scroll for more ads</f:facet>
				<h:panelGrid columns="1" style="width:100%;">
					<p:outputPanel>
						<div class="#{ad.category == 0 ? 'offer-title' : 'need-title'}"
							align="center">
							<p:outputLabel value="#{ad.category == 0? 'Offer:' : 'Need:'}"
								style="font-weight:bold;float:left"></p:outputLabel>
							<h:outputText value="#{ad.title}" styleClass="ad-font"
								style="float:left" />
							<p:commandButton
								style="float: right;margin-right:5px;margin-top:-3px;"
								rendered="#{ad.from or ad.to}" value="Show more"
								action="/user/ad_detail.xhtml?faces-redirect=true" ajax="false">
								<f:setPropertyActionListener value="#{ad}"
									target="#{adViewBean.selectedAd}" />
							</p:commandButton>
						</div>

						<h:panelGrid columns="4" cellpadding="5">
							<h:outputText value="Created:" />
							<h:outputText value="#{ad.createTime}" styleClass="ad-font">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy HH:mm"
									timeZone="Europe/Berlin" />
							</h:outputText>
							<h:outputText value="Created by:" />
							<h:outputText value="#{ad.user.username}" styleClass="ad-font" />

							<h:outputText value="Location from:" />
							<h:outputText value="#{ad.startingPoint}" styleClass="ad-font" />

							<h:outputText value="Location to:" />
							<h:outputText value="#{ad.destination}" styleClass="ad-font" />


							<h:outputText value="Seats left:" />
							<h:outputText value="#{ad.numberOfPersons}" styleClass="ad-font" />
							<h:outputText value="Start:" />
							<h:outputText value="#{ad.departureTime}" styleClass="ad-font">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy HH:mm"
									timeZone="Europe/Berlin" />
							</h:outputText>





						</h:panelGrid>
					</p:outputPanel>
				</h:panelGrid>
				<hr></hr>
			</p:dataScroller>
		</h:form>
	</div>
</ui:composition>

</html>


